#' Evaluate biological migraine risk factors
#'
#' This function calculates a biological risk score based on daily habits.
#'
#' @param migraines_month Integer. Number of migraines in the past month.
#' @param sleep_hours Numeric. Hours slept last night.
#' @param sleep_quality Character. "good" or "poor".
#' @param alcohol Logical. Did the user drink alcohol in the last 24 hours? (TRUE/FALSE)
#' Evaluate biological migraine risk factors
#'
#' This function calculates a biological risk score based on daily habits and
#' whether the user experienced any migraines in the current month.
#'
#' @param migraines_month Integer. Number of migraines in the past month.
#' @param sleep_hours Numeric. Hours slept last night.
#' @param sleep_quality Character. "good" or "poor".
#' @param alcohol Logical. Did the user drink alcohol in the last 24 hours? (TRUE/FALSE)
#' @param red_wine Logical. Did they drink red wine? (Only if alcohol is TRUE)
#' @param water_liters Numeric. How much water did they drink today? (liters)
#' @param caffeine_change Character. One of: "less", "normal", or "more".
#' @param hours_since_last_meal Numeric. How many hours since their last meal?
#'
#' @return A list with:
#'   \describe{
#'     \item{biological_score}{Numeric. Sum of risk factors including:
#'       - +1 if migraines_month &gt; 0
#'       - +1 if sleep_hours &lt; 7
#'       - +1 if sleep_quality == "poor"
#'       - +1 if alcohol is TRUE (additional +1 if red_wine is TRUE)
#'       - +1 if water_liters &lt; 2
#'       - +1 if caffeine_change != "normal"
#'       - +1 if hours_since_last_meal &gt; 4
#'     }
#'     \item{migraines_this_month}{Integer. Echo of migraines_month.}
#'   }
#' @export
#'
#' @examples
#' evaluate_biological_factors(
#'   migraines_month = 3,
#'   sleep_hours = 6,
#'   sleep_quality = "poor",
#'   alcohol = TRUE,
#'   red_wine = FALSE,
#'   water_liters = 1.5,
#'   caffeine_change = "more",
#'   hours_since_last_meal = 6
#' )
evaluate_biological_factors <- function(
    migraines_month,
    sleep_hours,
    sleep_quality,
    alcohol,
    red_wine,
    water_liters,
    caffeine_change,
    hours_since_last_meal
) {
  score <- 0

  # migraines this month
  if (migraines_month > 0) {
    score <- score + 1
  }

  # Sleep-related risk
  if (sleep_hours < 7) score <- score + 1
  if (tolower(sleep_quality) == "poor") score <- score + 1

  # Alcohol-related risk
  if (isTRUE(alcohol)) {
    score <- score + 1
    if (isTRUE(red_wine)) score <- score + 1
  }

  # Hydration and caffeine
  if (water_liters < 2) score <- score + 1
  if (tolower(caffeine_change) != "normal") score <- score + 1

  # Nutrition-related risk
  if (hours_since_last_meal > 4) score <- score + 1

  return(list(
    biological_score     = score,
    migraines_this_month = migraines_month
  ))
}
